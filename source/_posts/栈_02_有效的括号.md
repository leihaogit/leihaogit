---
title: '有效的括号'
date: '2023-05-03'
description: '使用栈辅助解决括号匹配问题'
cover: 'https://www.helloimg.com/images/2023/05/03/oqw655.jpg'
categories:

- 数据结构与算法

tags:

- Java
- 栈

---

> 栈（Stack）是一种只允许在一端进行插入或删除操作的线性表，是一种非常常见的数据结构。它具有后进先出（LIFO）的特点，适用于需要实现“先进后出”逻辑的场景，例如撤销操作、函数调用栈以及算法中的一些问题解决等。在今天的博客中，我们将介绍如何使用栈来辅助解决字符串的匹配这类问题。

# 一、栈

## 1.1 栈是什么

- 定义：栈就是一种只允许在一端进行插入或删除操作的线性表。
- 特点：其操作的运算受限，只允许在一端进行插入和删除操作。这一端被称为栈顶（Top），另一端被称为栈底（Bottom）。
- stack 意为整齐的一叠、一摞或者一堆；以一个实际场景为例，我们可以想象一个切菜过程中使用的盘子，菜刀不断地将切好的菜堆在盘子上，当需要用到其中一份菜时，只能从盘子的最顶部取出。
- 与栈相对应的另一种数据结构是队列（Queue）。队列也是一种线性结构，可以简单地理解为是只允许在一端进行插入操作，在另一端进行删除操作的线性表。这个后面再谈论。

<img src="https://www.helloimg.com/images/2023/04/28/oqXd9T.jpg">

## 1.2 使用场景

在一些算法或数据结构问题中，当涉及到`先进后出、后进先出`的操作时，可以考虑使用栈来解决问题。比如下面三个典型的算法模型：

1. 表达式求值：在计算表达式的值时，可以利用栈来实现计算。具体做法是将表达式中的操作数依次入栈，遇到操作符时弹出相应数量的操作数进行运算，将运算结果重新入栈，直到表达式中的所有元素都被处理完毕，最后栈中只剩下一个元素即为表达式的值。
2. 括号匹配：在检查括号是否匹配时，可以利用栈来实现。具体做法是遍历字符串中的每个字符，遇到左括号时将其入栈，遇到右括号时弹出栈顶元素进行匹配。如果当前字符是右括号，并且栈为空或者栈顶元素不是对应的左括号，就表示括号不匹配。
3. 函数调用栈：在编写递归函数时，每次进行函数调用时会将当前函数的状态信息（包括参数、局部变量、返回地址等）压入栈中，等到函数执行完毕后再弹出栈顶元素恢复状态。通过栈来维护函数调用的顺序和状态，可以实现递归函数的正常执行。

<img src="https://www.helloimg.com/images/2023/05/03/oqwl6u.gif">

注意：并不是所有涉及到`先进后出、后进先出`的操作都可以使用栈来解决，具体问题要具体分析。今天我们讨论的就是第二种模型，`括号匹配`（也可以叫字符串匹配）问题。

# 二、问题与思路

## 2.1 题目

**有效的括号**

- 给定一个只包括 '('，')'，'{'，'}'，'['，']'的字符串 s ，判断字符串是否有效。

    有效字符串需满足：

1. 左括号必须用相同类型的右括号闭合。
2. 左括号必须以正确的顺序闭合。
3. 每个右括号都有一个对应的相同类型的左括号。

来源：力扣（LeetCode）
链接：https://leetcode.cn/problems/valid-parentheses

示例 1：
输入：s = "()"
输出：true

示例 2：
输入：s = "()[]{}"
输出：true


## 2.2 思路

- 首先，我们思考一下如何判断一个字符串是否有效：
   1. 如果字符串中只有一个括号，那么显然不是有效字符串。
   2. 如果字符串中的左右括号数量不相等，那么也不是有效字符串。
   3. 如果字符串中的左右括号顺序不正确，那么同样不是有效字符串。

由于是要对左右括号进行匹配，而且**顺序**要正确，考虑使用**栈**来解决。
具体来说，我们可以遍历字符串，对于每个遇到的左括号，入栈；对于每个遇到的右括号，则需要与栈顶元素进行匹配。如果匹配成功，则弹出栈顶元素；如果匹配失败（即栈为空或栈顶元素不能与当前右括号匹配），则说明该字符串不是有效字符串。最后，如果栈不为空，则说明还有未匹配的左括号，也不是有效字符串。

- 然后，我们对算法进行分析
    1. 创建一个空栈。
    2. 遍历字符串s，对于每一个字符c，执行以下操作：
       - 如果c是左括号`(、{、[`，则将其入栈。
       - 如果c是右括号`)、}、]`：
         - 如果栈是空的，则返回false，因为此时没有左括号与之匹配。
         - 否则弹出栈顶元素，如果和当前的右括号不能匹配，则返回false。
    3. 如果遍历完整个字符串后，栈不为空，则说明有多余的左括号未被匹配，返回false；否则返回true。

## 2.3 演示

<img src="https://i.postimg.cc/Hxqght4K/juli.jpg">

- 示例一，对于字符串`(){}[]`，按上述步骤进行处理：
   1. 创建一个空栈。
   2. 遍历字符串：
       - 遇到'('，将其入栈。
       - 遇到')'，弹出'('，匹配成功。
       - 遇到'{'，将其入栈。
       - 遇到'}'，弹出'{'，匹配成功。
       - 遇到'['，将其入栈。
       - 遇到']'，弹出'['，匹配成功。
   3. 遍历完毕，栈为空，返回true。
<br>
- 示例二，对于字符串"{()[()]}"，按照上述步骤进行处理：
    1. 创建一个空栈。
    2. 遍历字符串：
       - 遇到'{'，将其入栈。
       - 遇到'('，将其入栈。
       - 遇到')'，弹出'('，匹配成功。
       - 遇到'['，将其入栈。
       - 遇到'('，将其入栈。
       - 遇到')'，弹出'('，匹配成功。
       - 遇到']'，弹出'['，匹配成功。
       - 遇到'}'，弹出'{'，匹配成功。
       - 当前栈：空。
    3. 遍历完毕，栈为空，返回true。
    下面是动画演示：

<img src="https://www.helloimg.com/images/2023/05/03/oqwDpA.gif">

# 三、题解

有了上面的分析，直接写出对应的代码，我会在每一步都加上注释：

```java
class Solution {
    public boolean isValid(String s) {
        Stack<Character> stack = new Stack<>(); // 创建一个空栈，用于存储左括号
        for (char c : s.toCharArray()) { // 遍历字符串
            if (c == '(' || c == '{' || c == '[') { // 如果是左括号，则入栈
                stack.push(c);
            } else { // 如果是右括号
                if (stack.isEmpty()) { // 如果栈为空，则返回false
                    return false;
                }
                char left = stack.pop(); // 弹出栈顶元素
                if ((c == ')' && left != '(') || (c == '}' && left != '{') || (c == ']' && left != '[')) {
                    // 如果右括号与栈顶元素不匹配，则返回false
                    return false;
                }
            }
        }
        return stack.isEmpty(); // 如果遍历完整个字符串后栈为空，则说明是有效的括号字符串
    }
}
```

# 四、总结

- 本文主要讲解了栈这种数据结构及其应用场景，以及如何使用栈来解决括号匹配问题。具体来说，栈是一种只允许在一端进行插入或删除操作的线性表，具有后进先出（LIFO）的特点。在算法或数据结构问题中，当需要对元素进行先进后出、后进先出的操作时，可以考虑使用栈来解决问题，例如逆序输出一个字符串、进行表达式求值、括号匹配等问题。括号匹配问题是常见的栈应用之一，其解决思路是遍历字符串，对于每个左括号入栈，对于每个右括号弹出栈顶元素进行匹配，直到遍历完整个字符串。如果栈为空，则说明所有左括号都有对应的右括号与之匹配，字符串是有效的括号序列。
- 学习栈这种数据结构不仅有助于理解算法和数据结构，还有利于提高代码编写的效率。在实际开发过程中，我们可以根据问题的需求来选择合适的数据结构和算法，从而更加高效地解决问题。